#include <SoftwareSerial.h> //needed for LCD screen

#define touchPin 0 //on touch pad 
#define trigPin 3 //on ultrasonic sensor
#define echoPin 4 //on ultrasonic sensor
#define rxPin   10  // Serial input (connects to Emic 2's SOUT pin)
#define txPin   11  // Serial output (connects to Emic 2's SIN pin)

 
SoftwareSerial mySerial(3,2); //Attach LCD serial display RX pin to digital pin 2

SoftwareSerial emicSerial = SoftwareSerial(rxPin, txPin);

int PressurePin = A0;
int force;

//Code runs once
void setup() {
  Serial.begin(9600); //allows for printing things 

  //for ultrasonic sensor
  pinMode(trigPin, OUTPUT); //for ultrasonic sensor
  pinMode(echoPin, INPUT);

  //for LCD screen
  mySerial.begin(9600); //set up serial port for 9600 baud on LCD screen
  delay(500); //wait for LCD to boot up
  
  // for text-to-speech module
  pinMode(rxPin, INPUT);
  pinMode(txPin, OUTPUT);  
  emicSerial.begin(9600);            
  
}

//Code loops
void loop() {
  
  //Ultrasonic sensor set up
  long duration; 
  long distance;
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  duration = pulseIn(echoPin, HIGH);
  distance = (duration/2)/29.1;
  Serial.println(distance); //prints out distance to surface on serial monitor


  //if person gets too close, then display message
  if(distance > 750){
    newLine();
    mySerial.write("Hello! My name is Boogie the robot. - Boogie");
    delay(1000);
  }
  else if(distance > 500){
    newLine();
    mySerial.write("Come closer and press the button! I see you there - Boogie the robot");
    delay(1000);
  }
  else if(distance > 250){
    newLine();
    mySerial.write("I can almost smell you! Get over here and press the button - Boogie the robot");
    delay(1000);
  }
  else if(distance > 75){
    newLine();
    mySerial.write("I can seeee you. Come close and press the button - Boogie the robot");
    delay(1000);
  }
  else if(distance > 40){
    newLine();
    mySerial.write("Press the button! You're basically over here - Boogie the robot");
    delay(1000);
  }
  else{
    newLine();
    mySerial.write("Press the button to see me dance! - Boogie the robot");
    delay(1000);
  }
  
  force = analogRead(PressurePin);
  if (force > 500) {
    emicSerial.print('S');
    emicSerial.print("Microsoft was founded by Paul Allen and Bill Gates on April 4, 1975, to develop and sell BASIC interpreters for the Altair 8800. It rose to dominate the personal computer operating system market with MS-DOS in the mid-1980s, followed by Microsoft Windows. The company's 1986 initial public offering (IPO), and subsequent rise in its share price, created three billionaires and an estimated 12,000 millionaires among Microsoft employees. Since the 1990s, it has increasingly diversified from the operating system market and has made a number of corporate acquisitions. In May 2011, Microsoft acquired Skype Technologies for $8.5 billion,[9] and in December 2016 bought LinkedIn for $26.2 billio");
    emicSerial.print('\n');
  }
  delay(100);

}

//Methods!

//clears LCD screen and sets cursor at start
void newLine(){
  mySerial.write(254);
  mySerial.write(128);
  mySerial.write("                                                                               ");
  mySerial.write(254);
  mySerial.write(128);
}



